{%- extends "templates/blogEntryBase.html" %}
{%- block blogEntry %}
<div class="blogtext">
	<p>
	The is a simple entry about how to have custom message display when logging into an Ubuntu server via SSH. Very simply, one can modify /etc/motd, but that's pretty plain. Bash commands can't be executed, nor can ascii color escape sequences be used. This blog entry will describe how to setup update-motd to execute a python script to display a message when logging via SSH. 
	</p>
	<p>Begin by installing update-motd using the terminal with 
	</p>
	<code class="w3-code w3-margin">sudo apt-get update-motd</code>	
	<p>Once installed </p>
	<code class="w3-code w3-margin">cd /etc/update-motd.d</code>
	<p>This directory holds all of the scripts that are executed when a succesful ssh connection is established. Check them out and see what you would like to keep or get rid of. Personally, I like to know when there are updates, the server's current software version, and the information about last login. The scripts are executed in ascending order based on the first two numbers in the scripts name. If the script does not begin with two numbers, then it is not executed. These scripts are not supposed to have file extensions, but they are not necessarily assumed to be bash scripts. The environment to execute the script in is determined by the shebang on the first line of the script. Below is an example of a python script named 30-hello that says hello to the user in a stylized way.
	</p>
	<div class="w3-code notranslate" style="color:black; font-family:"Lucida Console";">#!/usr/bin/env python3<br>
import sys<br>
<br>
a = '''<br>
O))     O))           O)) O))          O))<br>
O))     O))           O)) O))          O))<br>
O))     O))   O))     O)) O))   O))    O))<br>
O)))))) O)) O)   O))  O)) O)) O))  O)) O) <br>
O))     O))O))))) O)) O)) O))O))    O))O) <br>
O))     O))O)         O)) O)) O))  O))    <br>
O))     O))  O))))   O)))O)))   O))    O))<br>
'''<br>
white = '\033[0;37m'<br>
color = white<br>
violet = '\033[1;35m'<br>
green = '\033[1;32m'<br>
for i in range(len(a)):<br>
&nbsp;       if a[i] == ')':<br>
&nbsp;&nbsp;                if color != violet:<br>
&nbsp;&nbsp;&nbsp;                        color = violet<br>
&nbsp;&nbsp;&nbsp;                        sys.stdout.write(color)<br>
&nbsp;       else:<br>
&nbsp;&nbsp;                if color != green:<br>
&nbsp;&nbsp;&nbsp;                        color = green<br>
&nbsp;&nbsp;&nbsp;                        sys.stdout.write(color)<br>
&nbsp;       sys.stdout.write(a[i])<br>
sys.stdout.write(white)<br>
sys.stdout.flush()<br>
	</div>
	<p>At the top of the file, the shebang tells the computer to use the  python3 environment to execute this script. sys is imported to write to stdout, but the print() command could be used instead. I don't use print() because it appends a newline at the end of the string you tell it to print. The variable 'a' is used to store the desired message, which is ascii art for "Hello!". The variables with color names store the ascii escape sequences for the color the variable is named after. More information on these escape sequences can be found at <a target="_blank" href="https://en.wikipedia.org/wiki/ANSI_escape_code">wikipedia</a>, and a simple list of the escape sequences can be found <a target="_blank" href="http://www.linuxhowtos.org/Tips%20and%20Tricks/ansi_escape_sequences.htm">here.</a> The for loop steps through every charater in 'a', and sets the color to violet if the character is a right paren, and the color of the text is not already violet. It uses the same basic idea for the other symbols, but instead it turns them to green. Once th loops is done, it resets the color back to white so that the rest of the welcome message is printed in white. Finally stdout is flushed so that everything writes to stdout when the script ends, instead of waiting in some hidden stdout buffer that python uses.
	</p>
	<p>The ascii art was generated by <a target="_blank" href="http://www.patorjk.com/software/taag">http://www.patorjk.com/software/taag</a>
	<p>To see the result of the scripts, execute</p>
	<code class "w3-code w3-margin">sudo update-motd</code>
	<p>This example can be built upon to do more complicated things. For those interested, motd stands for message of the day. The python script can be setup to vary from day to day uaing the datetime python package.</p>
</div>
{% endblock %}
